import{r as w,j as e,D as _,S as I,C as k,b as T,R as U,t as o}from"./index-BonES2JO.js";import{Q as L}from"./index-k5O-CWLv.js";const d=({label:l,value:n})=>{if(n==null||n==="")return null;const h=typeof n=="boolean"?n?"Yes":"No":n;return e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-brand-gray-light",children:[e.jsx("span",{className:"text-sm text-brand-gray",children:l}),e.jsx("span",{className:"text-sm text-right text-brand-text font-medium",children:h})]})},O=({upnData:l,epcPayload:n,onReset:h,t:a})=>{const[b,p]=w.useState(!1),x=w.useRef(null),u=(r="image/png")=>new Promise(s=>{var y;const t=(y=x.current)==null?void 0:y.querySelector("svg");if(!t){s(null);return}const C=new XMLSerializer().serializeToString(t),i=document.createElement("canvas"),m=i.getContext("2d");if(!m){s(null);return}const c=new Image,S=new Blob([C],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(S);c.onload=()=>{i.width=c.width,i.height=c.height,m.fillStyle="white",m.fillRect(0,0,i.width,i.height),m.drawImage(c,0,0),URL.revokeObjectURL(g),i.toBlob(E=>{s(E)},r)},c.onerror=()=>{URL.revokeObjectURL(g),s(null)},c.src=g}),j=async()=>{const r=await u();if(!r){alert("Could not generate image for download."),o("download_qr","Engagement","failed");return}const s=URL.createObjectURL(r),t=document.createElement("a");t.href=s,t.download="epc-qr-code.png",document.body.appendChild(t),t.click(),document.body.removeChild(t),URL.revokeObjectURL(s),o("download_qr","Engagement","success")},N=async()=>{const r=await u();if(!r){alert("Could not generate image for sharing."),o("share_image","Sharing","generation_failed");return}const t={files:[new File([r],"epc-qr-code.png",{type:r.type})],title:a("shareTitle"),text:a("shareText")};if(navigator.canShare&&navigator.canShare(t))try{await navigator.share(t),o("share_image","Sharing","native_share_success")}catch(f){console.error("Share image failed:",f),o("share_image","Sharing","native_share_failed")}else alert(a("shareImageNotSupported")),o("share_image","Sharing","not_supported")},v=async()=>{try{await navigator.clipboard.writeText(n),p(!0),o("copy_epc_payload","Engagement","success"),setTimeout(()=>p(!1),2e3)}catch(r){console.error("Failed to copy EPC payload:",r),o("copy_epc_payload","Engagement","failed"),alert(a("copyEpcFailAlert"))}},R=(()=>{if(!l.amount)return"0.00 EUR";const r=l.amount.trim().replace(",",".");let s;if(r.includes("."))s=parseFloat(r);else{const t=parseInt(r,10);s=isNaN(t)?NaN:t/100}return isNaN(s)?a("ERROR_INVALID_AMOUNT"):`${s.toFixed(2)} EUR`})();return e.jsxs("div",{className:"bg-white border border-brand-gray-light p-6 rounded-lg shadow-sm w-full max-w-md mx-auto flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-brand-primary mb-2",children:a("resultTitle")}),e.jsx("p",{className:"text-brand-gray mb-6 text-center",children:a("resultDescription")}),e.jsx("div",{ref:x,className:"bg-white p-4 rounded-lg mb-6",children:e.jsx(L,{value:n,size:256,level:"M",includeMargin:!0})}),e.jsxs("div",{className:"w-full mb-6 bg-brand-light-dark p-4 rounded-lg border border-brand-gray-light",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-2",children:a("howToPayTitle")}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-brand-gray-dark text-sm",children:[e.jsx("li",{children:a("howToPayStep1")}),e.jsx("li",{children:a("howToPayStep2")}),e.jsx("li",{children:a("howToPayStep3")})]})]}),e.jsxs("div",{className:"w-full mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-brand-text mb-2 text-center border-b border-brand-gray-light pb-2",children:a("originalDataTitle")}),e.jsxs("div",{className:"mt-2",children:[e.jsx(d,{label:a("recipient"),value:l.recipientName}),e.jsx(d,{label:a("iban"),value:l.recipientIBAN}),e.jsx(d,{label:a("amount"),value:R}),e.jsx(d,{label:a("purpose"),value:l.purpose}),e.jsx(d,{label:a("reference"),value:l.recipientReference})]})]}),e.jsxs("div",{className:"w-full flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:j,className:"w-full bg-brand-primary text-white font-semibold py-3 px-6 rounded-lg hover:bg-brand-primary-hover transition-colors shadow-sm hover:shadow-md flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),a("downloadImage")]}),e.jsxs("button",{onClick:N,className:"w-full bg-white text-brand-primary font-semibold py-3 px-6 rounded-lg hover:bg-brand-light-dark transition-colors border-2 border-brand-primary shadow-sm hover:shadow-md flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),a("shareImage")]})]}),e.jsxs("button",{onClick:v,className:"w-full bg-brand-primary text-white font-semibold py-3 px-6 rounded-lg hover:bg-brand-primary-hover transition-colors shadow-sm hover:shadow-md flex items-center justify-center gap-2",children:[b?e.jsx(k,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"}),a(b?"epcPayloadCopied":"copyEpcPayload")]}),e.jsxs("button",{onClick:h,className:"w-full bg-white text-brand-gray font-medium py-2 px-6 rounded-lg hover:bg-brand-light-dark transition-colors flex items-center justify-center gap-2 border border-brand-gray-light",children:[e.jsx(U,{className:"w-5 h-5"}),a("scanAnother")]})]})]})};export{O as default};
