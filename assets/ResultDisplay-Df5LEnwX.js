import{r as y,j as e,D as _,S as I,C as k,b as T,R as U,t as o}from"./index-n3YvM4MH.js";import{Q as L}from"./index-CYr1tbx6.js";const d=({label:n,value:l})=>{if(l==null||l==="")return null;const h=typeof l=="boolean"?l?"Yes":"No":l;return e.jsxs("div",{className:"flex justify-between items-start py-2 border-b border-gray-700",children:[e.jsx("span",{className:"text-sm text-brand-gray",children:n}),e.jsx("span",{className:"text-sm text-right text-white font-medium",children:h})]})},O=({upnData:n,epcPayload:l,onReset:h,t:a})=>{const[u,b]=y.useState(!1),x=y.useRef(null),p=(t="image/png")=>new Promise(s=>{var w;const r=(w=x.current)==null?void 0:w.querySelector("svg");if(!r){s(null);return}const C=new XMLSerializer().serializeToString(r),i=document.createElement("canvas"),m=i.getContext("2d");if(!m){s(null);return}const c=new Image,S=new Blob([C],{type:"image/svg+xml;charset=utf-8"}),g=URL.createObjectURL(S);c.onload=()=>{i.width=c.width,i.height=c.height,m.fillStyle="white",m.fillRect(0,0,i.width,i.height),m.drawImage(c,0,0),URL.revokeObjectURL(g),i.toBlob(E=>{s(E)},t)},c.onerror=()=>{URL.revokeObjectURL(g),s(null)},c.src=g}),j=async()=>{const t=await p();if(!t){alert("Could not generate image for download."),o("download_qr","Engagement","failed");return}const s=URL.createObjectURL(t),r=document.createElement("a");r.href=s,r.download="epc-qr-code.png",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(s),o("download_qr","Engagement","success")},N=async()=>{const t=await p();if(!t){alert("Could not generate image for sharing."),o("share_image","Sharing","generation_failed");return}const r={files:[new File([t],"epc-qr-code.png",{type:t.type})],title:a("shareTitle"),text:a("shareText")};if(navigator.canShare&&navigator.canShare(r))try{await navigator.share(r),o("share_image","Sharing","native_share_success")}catch(f){console.error("Share image failed:",f),o("share_image","Sharing","native_share_failed")}else alert(a("shareImageNotSupported")),o("share_image","Sharing","not_supported")},v=async()=>{try{await navigator.clipboard.writeText(l),b(!0),o("copy_epc_payload","Engagement","success"),setTimeout(()=>b(!1),2e3)}catch(t){console.error("Failed to copy EPC payload:",t),o("copy_epc_payload","Engagement","failed"),alert(a("copyEpcFailAlert"))}},R=(()=>{if(!n.amount)return"0.00 EUR";const t=n.amount.trim().replace(",",".");let s;if(t.includes("."))s=parseFloat(t);else{const r=parseInt(t,10);s=isNaN(r)?NaN:r/100}return isNaN(s)?a("ERROR_INVALID_AMOUNT"):`${s.toFixed(2)} EUR`})();return e.jsxs("div",{className:"bg-brand-light-dark p-6 rounded-lg shadow-xl w-full max-w-md mx-auto flex flex-col items-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:a("resultTitle")}),e.jsx("p",{className:"text-brand-gray mb-6 text-center",children:a("resultDescription")}),e.jsx("div",{ref:x,className:"bg-white p-4 rounded-lg mb-6",children:e.jsx(L,{value:l,size:256,level:"M",includeMargin:!0})}),e.jsxs("div",{className:"w-full mb-6 bg-brand-dark/50 p-4 rounded-lg border border-brand-gray/50",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:a("howToPayTitle")}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-gray-300 text-sm",children:[e.jsx("li",{children:a("howToPayStep1")}),e.jsx("li",{children:a("howToPayStep2")}),e.jsx("li",{children:a("howToPayStep3")})]})]}),e.jsxs("div",{className:"w-full mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2 text-center border-b border-gray-700 pb-2",children:a("originalDataTitle")}),e.jsxs("div",{className:"mt-2",children:[e.jsx(d,{label:a("recipient"),value:n.recipientName}),e.jsx(d,{label:a("iban"),value:n.recipientIBAN}),e.jsx(d,{label:a("amount"),value:R}),e.jsx(d,{label:a("purpose"),value:n.purpose}),e.jsx(d,{label:a("reference"),value:n.recipientReference})]})]}),e.jsxs("div",{className:"w-full flex flex-col gap-4",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("button",{onClick:j,className:"w-full bg-brand-blue text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(_,{className:"w-5 h-5"}),a("downloadImage")]}),e.jsxs("button",{onClick:N,className:"w-full bg-brand-blue text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[e.jsx(I,{className:"w-5 h-5"}),a("shareImage")]})]}),e.jsxs("button",{onClick:v,className:"w-full bg-brand-blue text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center gap-2",children:[u?e.jsx(k,{className:"w-5 h-5"}):e.jsx(T,{className:"w-5 h-5"}),a(u?"epcPayloadCopied":"copyEpcPayload")]}),e.jsxs("button",{onClick:h,className:"w-full bg-transparent text-brand-gray font-medium py-2 px-6 rounded-lg hover:bg-brand-light-dark/50 transition-colors flex items-center justify-center gap-2 border border-brand-gray",children:[e.jsx(U,{className:"w-5 h-5"}),a("scanAnother")]})]})]})};export{O as default};
