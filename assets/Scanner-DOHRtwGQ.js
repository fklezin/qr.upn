const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-BNG5YSNc.js","assets/index-n3YvM4MH.js"])))=>i.map(i=>d[i]);
import{r as l,j as r,A as O,F as R,a as k,_ as E}from"./index-n3YvM4MH.js";const g="qr-reader",N=({onSuccess:m,onError:p,onCancel:j,t:o})=>{const a=l.useRef(null),[d,S]=l.useState(!1),[b,x]=l.useState(!1),i=l.useRef(null),w=l.useRef(!1);l.useEffect(()=>{let e=!0,f=null;return(async()=>{try{const{Html5Qrcode:s}=await E(async()=>{const{Html5Qrcode:t}=await import("./index-BNG5YSNc.js");return{Html5Qrcode:t}},__vite__mapDeps([0,1]));if(!e)return;const u=new s(g);if(a.current=u,u.isScanning)return;await u.start({facingMode:"environment"},{fps:10,qrbox:(t,n)=>{const h=Math.min(t,n),c=Math.floor(h*.8);return{width:c,height:c}},aspectRatio:1},(t,n)=>{a.current&&a.current.isScanning&&a.current.stop().then(()=>m(t)).catch(h=>console.error("Failed to stop scanner on success",h))},t=>{}),f=setTimeout(()=>{if(!e)return;const t=document.getElementById(g);if(t){const n=t.querySelector("video");if(n&&n.srcObject){const c=n.srcObject.getVideoTracks()[0];if(c){i.current=c;const v=c.getCapabilities();v&&"torch"in v&&x(!0)}}}},100)}catch(s){if(e){const u=s instanceof Error?s.message:"Failed to start camera.";p(u)}}})(),()=>{e=!1,f&&clearTimeout(f),i.current&&w.current&&i.current.applyConstraints({advanced:[{torch:!1}]}).catch(()=>{}),a.current&&a.current.isScanning&&a.current.stop().catch(s=>console.error("Failed to stop scanner on cleanup.",s))}},[m,p]);const y=async()=>{if(!(!i.current||!b))try{const e=!d;await i.current.applyConstraints({advanced:[{torch:e}]}),S(e),w.current=e}catch(e){console.error("Failed to toggle flashlight:",e),x(!1)}};return r.jsxs("div",{className:"w-full max-w-lg mx-auto p-4 bg-brand-light-dark rounded-lg shadow-lg relative",children:[r.jsx("div",{id:g,className:"w-full rounded-md overflow-hidden"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:r.jsx("div",{className:"w-[80%] h-[80%] max-w-xs max-h-xs border-4 border-white/50 rounded-lg shadow-inner",style:{boxShadow:"0 0 0 9999px rgba(0,0,0,0.5)"}})}),r.jsx("button",{onClick:j,className:"absolute top-4 left-4 bg-black/50 text-white rounded-full p-2 hover:bg-black/75 transition-colors","aria-label":o("scannerCancel"),children:r.jsx(O,{className:"w-6 h-6"})}),b&&r.jsx("button",{onClick:y,className:"absolute top-4 right-4 bg-black/50 text-white rounded-full p-2 hover:bg-black/75 transition-colors","aria-label":o(d?"flashlightOff":"flashlightOn"),title:o(d?"flashlightOff":"flashlightOn"),children:d?r.jsx(R,{className:"w-6 h-6"}):r.jsx(k,{className:"w-6 h-6"})})]})};export{N as default};
