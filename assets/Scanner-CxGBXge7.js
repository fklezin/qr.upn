const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DWlexvfD.js","assets/index-DfrvWGgS.js"])))=>i.map(i=>d[i]);
import{r as i,j as r,A as O,F as R,a as E,_ as F}from"./index-DfrvWGgS.js";const m="qr-reader",I=({onSuccess:g,onError:b,onCancel:y,t:c})=>{const a=i.useRef(null),[h,j]=i.useState(!1),[p,x]=i.useState(!1),l=i.useRef(null),w=i.useRef(!1);i.useEffect(()=>{let e=!0,f=null;return(async()=>{try{const{Html5Qrcode:s}=await F(async()=>{const{Html5Qrcode:t}=await import("./index-DWlexvfD.js");return{Html5Qrcode:t}},__vite__mapDeps([0,1]));if(!e)return;const d=new s(m);if(a.current=d,d.isScanning)return;await d.start({facingMode:"environment"},{fps:10,qrbox:(t,n)=>{const u=Math.min(t,n),o=Math.floor(u*.8);return{width:o,height:o}},aspectRatio:1},(t,n)=>{a.current&&a.current.isScanning&&a.current.stop().then(()=>g(t)).catch(u=>console.error("Failed to stop scanner on success",u))},t=>{}),f=setTimeout(()=>{if(!e)return;const t=document.getElementById(m);if(t){const n=t.querySelector("video");if(n&&n.srcObject){const o=n.srcObject.getVideoTracks()[0];if(o){l.current=o;const v=o.getCapabilities();v&&"torch"in v&&x(!0)}}}},100)}catch(s){if(e){const d=s instanceof Error?s.message:"Failed to start camera.";b(d)}}})(),()=>{e=!1,f&&clearTimeout(f),l.current&&w.current&&l.current.applyConstraints({advanced:[{torch:!1}]}).catch(()=>{}),a.current&&a.current.isScanning&&a.current.stop().catch(s=>console.error("Failed to stop scanner on cleanup.",s))}},[g,b]);const S=async()=>{if(!(!l.current||!p))try{const e=!h;await l.current.applyConstraints({advanced:[{torch:e}]}),j(e),w.current=e}catch(e){console.error("Failed to toggle flashlight:",e),x(!1)}};return r.jsxs("div",{className:"w-full max-w-lg mx-auto p-4 bg-white border border-brand-gray-light rounded-lg shadow-sm relative",children:[r.jsx("div",{id:m,className:"w-full rounded-md overflow-hidden"}),r.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:r.jsx("div",{className:"w-[80%] h-[80%] max-w-xs max-h-xs border-4 border-brand-primary/60 rounded-lg shadow-inner",style:{boxShadow:"0 0 0 9999px rgba(0,0,0,0.5)"}})}),r.jsx("button",{onClick:y,className:"absolute top-4 left-4 bg-white border border-brand-primary text-brand-primary rounded-full p-2 hover:bg-brand-primary hover:text-white transition-colors shadow-sm","aria-label":c("scannerCancel"),children:r.jsx(O,{className:"w-6 h-6"})}),p&&r.jsx("button",{onClick:S,className:"absolute top-4 right-4 bg-white border border-brand-primary text-brand-primary rounded-full p-2 hover:bg-brand-primary hover:text-white transition-colors shadow-sm","aria-label":c(h?"flashlightOff":"flashlightOn"),title:c(h?"flashlightOff":"flashlightOn"),children:h?r.jsx(R,{className:"w-6 h-6"}):r.jsx(E,{className:"w-6 h-6"})})]})};export{I as default};
